##  JS是一门单线程的非阻塞的脚本语言
>https://segmentfault.com/a/1190000014872028
### 首先区分进程和线程
+ 进程是CPU资源分配的最小单位(是能够拥有资源和独立运行的最小单位)
+ 线程是CPU调度的最小单位
+ 一个进程由一个或多个线程组成
+ 通俗的讲：进程是一个工厂，工厂有它独立的资源，工厂之间相互独立->进程之间相互独立，线程是工厂中的工人，多个工人之间可以协作完成任务，工厂内有一个或多个工人，工人之间共享空间。

#### 浏览器是多进程的
+ Browser进程： 浏览器主进程 只有一个 负责协调主控
    + 负责浏览器界面的显示、与用户交互（如前进、后退等）
    + 负责各个页面的管理，创建和销毁其他进程；
    + 将Renderer进程得到的内存中的Bitmap绘制到用户界面上
    + 网络资源的管理和下载等
+ 第三方插件进程 每种类型的插件对应一个进程，仅当该插件使用时才创建；
+ GPU进程 最多一个 用于3D绘图等
+ 浏览器渲染进程（render进程）浏览器内核
    + 负责页面的渲染，脚本的执行，事件的处理
    + 每打开一个Tab页，就相当于创建了一个独立的浏览器进程（某些情况下多个tab由于优化策略会合并）
#### 浏览器多进程的优势
+ 避免单个page crash影响整个浏览器；
+ 避免第三方插件crash影响整个浏览器
+ 多进程充分利用多核优势；
+ 方便使用沙盒模型隔离插件等进程，提高浏览器稳定性
>简单点理解：如果浏览器是单进程，那么某个tab页或第三方插件崩溃了，就会导致整个浏览器崩溃，体验度极差，不过多进程内存消耗会更大，有点用空间换时间。
#### 浏览器的渲染进程是多线程的
+ GUI渲染线程 
    + 负责渲染浏览器界面，解析HTML，CSS，构建DOM树 布局和绘制等
    + 当界面需要重绘（Repaint）或由于某种操作引发回流（reflow）时该线程会执行
    + 注意：GUI渲染线程和JS引擎线程是互斥的，当JS引擎执行时GUI线程会被挂起，GUI更新会保存在一个队列中等JS引擎空闲时立即执行
+ JS引擎线程 也称为JS内核
    + 负责解析Javascript脚本，运行代码 （V8引擎）
    + JS引擎一直等待着任务队列中的任务到来，然后加以处理，一个tab页面（renderer进程）中无论什么时候都只有一个JS线程在运行JS程序；
    + 注意：由于GUI渲染线程和JS引擎线程是互斥的，所以如果JS程序运行时间过长，这样会导致页面渲染不连贯，导致页面渲染加载阻塞
+ 事件触发线程 将对应任务添加到事件线程中，当事件符合触发条件被触发事件触发时才执行
    + 归属于浏览器，而不是JS引擎，用来控制事件循环；
    + 当JS引擎执行代码块如setTimeOut时（也可以来自浏览器内核的其他线程，如鼠标单击事件、AJAX异步请求等），会将对应的任务添加到事件线程中
    + 当对应的事件符合触发条件被触发时，该线程就会把事件添加到JS的待处理队列的队尾，等待JS引擎的处理；
    + 注意：由于JS的单线程的关系所以这些待处理队列中的事件都得排队等待JS引擎处理（当JS引擎空闲时才会去执行）
+ 定时触发器线程 
    + setInterval与setTimeout所在线程
    + 浏览器的定时计数器并不是由JavaScript引擎计数的
+ 异步http请求线程 
    + 在XMLHttpRequest在连接后通过浏览器新开一个线程请求
    + 将检测到状态变更时，如果设置有回调函数，异步线程就将产生状态变更事件，将这个回调在放到事件队列中，再由JavaScript引擎执行
# 事件循环机制
## 浏览器环境下js引擎的事件循环机制
### 1.执行栈与事件队列
### 2.macro task与micro task