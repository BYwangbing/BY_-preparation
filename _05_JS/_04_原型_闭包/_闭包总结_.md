> https://blog.csdn.net/qq_42098849/article/details/108016366

## 闭包
阮一峰网络日志：闭包：
>http://www.ruanyifeng.com/blog/2009/08/learning_javascript_closures.html

+ 变量的作用域无非就是两种：全局变量和局部变量
+ Javascript语言的特殊之处，就在于函数内部可以直接读取全局变量
+ 另一方面，在函数外部自然无法读取函数内的局部变量

只有函数内部的子函数才能读取局部变量，因此可以把闭包简单理解成"定义在一个函数内部的函数"。

+ JS中存在两种变量作用域，分别是局部变量和全局变量，这两种变量存在区别就是函数内部的可以访问全局变量，但是函数外部无法访问函数内的局部变量。
+ 闭包就是有权访问另一函数作用域中局部变量的函数
+ 闭包就是可以创建一个独立的环境，每个闭包里面的环境都是独立的，并且互不干扰。
+ 每次外部函数执行的时候，外部函数的引用地址不同，都会重新创建一个新的地址

### 闭包的特点：
1. 让外部访问函数内部变量成为可能
2. 局部变量会常驻在内存中
3. 可以避免使用全局变量，防止全局变量污染
4. 会造成内存泄漏
### 闭包的应用场景
1. 循环打印，for循环嵌套打印的时候会打印最后的值，可以应用闭包避免
2. 解决setTimeout第一个参数函数不能传参的问题
3. 创建一个计数器，而且可以多次利用每次外部函数执行的时候，外部函数的引用地址不同，都会重新创建一个新的地址
4. 小范围代替全局变量
5. 防抖函数中避免全局变量的使用造成污染
6. 函数柯理化
7. 将函数作为另外一个函数的返回值
8.  将函数作为实参传递给另外一个函数调用
### 哪些操作会造成内存泄漏？
1. 意外的全局变量
2. 未及时清理的计时器或回调函数
3. 脱离 DOM 的引用
4. 闭包

+ 第一种情况是我们由于使用未声明的变量，而意外的创建了一个全局变量，而使这个变量一直留在内存中无法被回收。
+ 第二种情况是我们设置了setInterval定时器，而忘记取消它，如果循环函数有对外部变量的引用的话，那么这个变量会被一直留在内存中，而无法被回收。
+ 第三种情况是我们获取一个DOM元素的引用，而后面这个元素被删除，由于我们一直保留了对这个元素的引用，所以它也无法被回收。
+ 第四种情况是不合理的使用闭包，从而导致某些变量一直被留在内存当中

程序执行的四个阶段
+ 第一阶段：在内存中创建执行环境栈、把全局对象window压入栈底、在window中声明变量
+ 第二阶段：函数调用时
+ 第三阶段：函数调用后
